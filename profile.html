<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ù…Ø¹Ù„Ù… - Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                                <a href="index.html" class="nav-link"><h2>ğŸ“ Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</h2></a>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="teachers.html" class="nav-link">Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ†</a>
                <a href="lessons.html" class="nav-link">Ø§Ù„Ø¯Ø±ÙˆØ³</a>
            </div>
            <div class="nav-auth" id="navAuth">
                <a href="login.html" class="btn btn-outline">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
                <a href="register.html" class="btn btn-primary">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</a>
            </div>
            <div class="nav-user hidden" id="navUser">
                <div class="user-dropdown">
                    <button class="user-name-btn" id="userName" onclick="toggleUserMenu()"></button>
                    <div class="user-menu" id="userMenu">
                        <a href="teacher-dashboard.html" id="dashboardLink" class="hidden user-menu-item">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
                        <button onclick="openSettings()" class="user-menu-item">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                        <button onclick="logout()" class="user-menu-item logout-btn">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                        <div class="user-email" id="userEmail">example@gmail.com</div>
                    </div>
                </div>
            </div>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">â˜°</button>
        </div>
    </nav>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main style="padding: 2rem 0; min-height: 80vh;">
        <div class="container">
            <!-- Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ø´Ø®ØµÙŠ -->
            <div id="teacherProfile">
                <div class="loading" style="text-align: center; padding: 4rem;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...</div>
            </div>

            <!-- Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø¹Ù„Ù… -->
            <div id="teacherLessons" style="margin-top: 3rem;">
                <div class="loading" style="text-align: center; padding: 4rem;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ø±ÙˆØ³...</div>
            </div>
        </div>
    </main>

    <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</h3>
                    <p>Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø´Ø§Ù…Ù„Ø© ØªÙ‡Ø¯Ù Ø¥Ù„Ù‰ ØªØ·ÙˆÙŠØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø±Ù‚Ù…ÙŠ</p>
                </div>
                <div class="footer-section">
                    <h4>Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h4>
                    <ul>
                        <li><a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                        <li><a href="teachers.html">Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ†</a></li>
                        <li><a href="lessons.html">Ø§Ù„Ø¯Ø±ÙˆØ³</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Ø§Ù„Ø­Ø³Ø§Ø¨</h4>
                    <ul>
                        <li><a href="login.html">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a></li>
                        <li><a href="register.html">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        let currentTeacher = null;
        let teacherLessons = [];

        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadTeacherProfile();
        });

        async function loadTeacherProfile() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¹Ù„Ù… Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
            const urlParams = new URLSearchParams(window.location.search);
            const teacherId = urlParams.get('id');

            if (!teacherId) {
                showError('Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¹Ù„Ù… ØºÙŠØ± ØµØ­ÙŠØ­');
                return;
            }

            try {
                // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…
                const teacherResponse = await fetch('/api/teachers');
                const teachers = await teacherResponse.json();
                
                currentTeacher = teachers.find(t => t.id == teacherId);
                
                if (!currentTeacher) {
                    showError('Ø§Ù„Ù…Ø¹Ù„Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                    return;
                }

                // ØªØ­Ù…ÙŠÙ„ Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø¹Ù„Ù…
                const lessonsResponse = await fetch('/api/lessons');
                const allLessons = await lessonsResponse.json();
                
                teacherLessons = allLessons.filter(lesson => (lesson.teacherId || lesson.teacher_id) == teacherId);

                displayTeacherProfile();
                displayTeacherLessons();
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ:', error);
                showError('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…');
            }
        }

        function displayTeacherProfile() {
            const firstName = currentTeacher.first_name || currentTeacher.firstName || '';
            const lastName = currentTeacher.last_name || currentTeacher.lastName || '';
            const lessonsCount = currentTeacher.lessonsCount || currentTeacher.lessons_count || 0;
            
            document.title = `${firstName} ${lastName} - Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ`;
            
            const profileSection = document.getElementById('teacherProfile');
            profileSection.innerHTML = `
                <div style="background: var(--card-bg); border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);">
                    <!-- Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø¹Ù„Ù… -->
                    <div style="background: linear-gradient(135deg, #2563EB, #059669); height: 200px; position: relative;">
                        <div style="position: absolute; bottom: -50px; right: 2rem;">
                            <div style="width: 120px; height: 120px; background: linear-gradient(135deg, #F59E0B, #EF4444); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 3rem; font-weight: 700; border: 6px solid white; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);">
                                ${firstName.charAt(0)}${lastName.charAt(0)}
                            </div>
                        </div>
                    </div>

                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù… -->
                    <div style="padding: 4rem 2rem 2rem;">
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 2rem; align-items: start;">
                            <div>
                                <h1 style="font-size: 2.5rem; font-weight: 700; color: var(--text-color); margin-bottom: 0.5rem;">${firstName} ${lastName}</h1>
                                <p style="font-size: 1.25rem; color: var(--primary-color); font-weight: 600; margin-bottom: 1rem;">${currentTeacher.specialization || 'Ù…Ø¹Ù„Ù…'}</p>
                                
                                ${currentTeacher.bio ? `<p style="color: var(--secondary-color); line-height: 1.7; margin-bottom: 2rem; font-size: 1.125rem;">${currentTeacher.bio}</p>` : ''}
                                
                                <div style="display: flex; gap: 2rem; flex-wrap: wrap; margin-bottom: 2rem;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">${lessonsCount}</div>
                                        <div style="color: var(--secondary-color); font-size: 0.875rem;">Ø¯Ø±Ø³ Ù…Ù†Ø´ÙˆØ±</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">${currentTeacher.experience || 0}</div>
                                        <div style="color: var(--secondary-color); font-size: 0.875rem;">Ø³Ù†Ø© Ø®Ø¨Ø±Ø©</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">4.9</div>
                                        <div style="color: var(--secondary-color); font-size: 0.875rem;">ØªÙ‚ÙŠÙŠÙ…</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">247</div>
                                        <div style="color: var(--secondary-color); font-size: 0.875rem;">Ø·Ø§Ù„Ø¨</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <button onclick="contactTeacher()" class="btn btn-primary">ğŸ“§ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…</button>
                                <button onclick="followTeacher()" class="btn btn-outline">â­ Ù…ØªØ§Ø¨Ø¹Ø©</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function displayTeacherLessons() {
            const firstName = currentTeacher.first_name || currentTeacher.firstName || '';
            const lastName = currentTeacher.last_name || currentTeacher.lastName || '';
            const lessonsSection = document.getElementById('teacherLessons');
            
            if (teacherLessons.length === 0) {
                lessonsSection.innerHTML = `
                    <div style="background: var(--card-bg); padding: 3rem; border-radius: 16px; text-align: center;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“š</div>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem; color: var(--text-color);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ù…Ù†Ø´ÙˆØ±Ø©</h3>
                        <p style="color: var(--secondary-color);">Ù„Ù… ÙŠÙ†Ø´Ø± Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¹Ù„Ù… Ø£ÙŠ Ø¯Ø±ÙˆØ³ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>
                    </div>
                `;
                return;
            }

            lessonsSection.innerHTML = `
                <div style="background: var(--card-bg); padding: 2rem; border-radius: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);">
                    <h2 style="font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-color);">Ø¯Ø±ÙˆØ³ ${firstName} ${lastName}</h2>
                    
                    <div class="teacher-lessons-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem;">
                        ${teacherLessons.map(lesson => `
                            <div class="teacher-lesson-card" style="border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 10px 25px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.05)'">
                                <!-- Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¯Ø±Ø³ -->
                                <div class="lesson-media" style="aspect-ratio: 16/9; background: linear-gradient(135deg, #2563EB, #059669); display: flex; align-items: center; justify-content: center; position: relative;">
                                    ${lesson.youtubeUrl ? `
                                        <div style="color: white; font-size: 3rem;">ğŸ“¹</div>
                                        <div style="position: absolute; bottom: 8px; left: 8px; background: rgba(0,0,0,0.7); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">
                                            ${lesson.duration || 30} Ø¯Ù‚ÙŠÙ‚Ø©
                                        </div>
                                    ` : lesson.pdfUrl ? `
                                        <div style="color: white; font-size: 3rem;">ğŸ“„</div>
                                        <div style="position: absolute; bottom: 8px; left: 8px; background: rgba(0,0,0,0.7); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">PDF</div>
                                    ` : `
                                        <div style="color: white; font-size: 3rem;">ğŸ“š</div>
                                    `}
                                </div>

                                <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø³ -->
                                <div class="lesson-content" style="padding: 1.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span style="background: #EBF4FF; color: #2563EB; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">${lesson.subject}</span>
                                        <span style="color: var(--secondary-color); font-size: 0.875rem;">ğŸ“… ${formatArabicDate(lesson.createdAt)}</span>
                                    </div>

                                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--text-color); line-height: 1.3;">${lesson.title}</h3>
                                    
                                    <p style="color: var(--secondary-color); line-height: 1.6; margin-bottom: 1.5rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">${lesson.description}</p>

                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <div class="teacher-lesson-stats" style="display: flex; gap: 1rem; font-size: 0.875rem; color: var(--secondary-color);">
                                            <span>ğŸ‘ï¸ ${lesson.views || 0}</span>
                                            <span>ğŸ‘ ${lesson.likes || 0}</span>
                                        </div>
                                    </div>

                                    <a href="lesson-view.html?id=${lesson.id}" class="btn btn-primary" style="width: 100%; text-align: center; text-decoration: none;">Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¯Ø±Ø³</a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function showError(message) {
            document.getElementById('teacherProfile').innerHTML = `
                <div style="text-align: center; padding: 4rem;">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">âŒ</div>
                    <h2 style="font-size: 1.5rem; font-weight: 600; color: #EF4444; margin-bottom: 1rem;">${message}</h2>
                    <a href="teachers.html" class="btn btn-primary">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</a>
                </div>
            `;
            document.getElementById('teacherLessons').innerHTML = '';
        }

        function contactTeacher() {
            alert('Ù…ÙŠØ²Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù… Ø³ØªÙƒÙˆÙ† Ù…ØªØ§Ø­Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }

        function followTeacher() {
            alert('Ù…ÙŠØ²Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø¹Ù„Ù… Ø³ØªÙƒÙˆÙ† Ù…ØªØ§Ø­Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }
    </script>
</body>
</html>